language: java
install: mvn install -DskipTests

before_install:
  - openssl aes-256-cbc -K $encrypted_b9997e150274_key -iv $encrypted_b9997e150274_iv -in key.asc.enc -out key.asc -d
  - echo $PGP_PASSPHRASE | gpg --passphrase-fd 0 --batch --yes --import key.asc

after_success:
- bash <(curl -s https://codecov.io/bash)

cache:
  directories:
  - "$HOME/.m2"

deploy:
- provider: script
  script: mvn -X deploy --settings .travis/settings.xml -Dgpg.passphrase=${PGP_PASSPHRASE} -DskipTests=true -B -U -Prelease
  skip_cleanup: true
  on:
    repo: imrafaelmerino/json-values
    tags: true
- provider: releases
  skip_cleanup: true
  api_key: "$GITHUB_TOKEN"
  draft: false
  prerelease: false
  body: 'Generated by TravisCI during the release process: build URL: $TRAVIS_BUILD_WEB_URL,
    build number: $TRAVIS_BUILD_NUMBER, commit: $TRAVIS_COMMIT, tag: $TRAVIS_TAG'
  name: Fito
  file:
  - target/JAVADOC.zip
  - docs/CHANGELOG.md
  - docs/README.md
  - target/SOURCES.zip
  on:
    repo: imrafaelmerino/json-values
    tags: true
addons:
  sonarcloud:
    organization: imrafaelmerino
script:
  - mvn clean verify -DskipTests=true -Pcoverage -Dsonar.projectKey=imrafaelmerino_json-values


